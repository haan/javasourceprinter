<VirtualHost *:80>
  ServerName java.haan.lu
  Redirect permanent / https://java.haan.lu/
</VirtualHost>

<VirtualHost *:443>
  ServerName java.haan.lu
  DocumentRoot /var/www/java/dist

  <Directory /var/www/java/dist>
    Options -Indexes +FollowSymLinks
    AllowOverride None
    Require all granted
  </Directory>

  ProxyPreserveHost On
  ProxyPass /api/ http://127.0.0.1:3001/api/
  ProxyPassReverse /api/ http://127.0.0.1:3001/api/
  RequestHeader set X-Forwarded-Proto "https"

  ErrorLog ${APACHE_LOG_DIR}/java.haan.lu-error.log
  CustomLog ${APACHE_LOG_DIR}/java.haan.lu-access.log combined

  SSLEngine on
  SSLCertificateFile /etc/letsencrypt/live/java.haan.lu/fullchain.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/java.haan.lu/privkey.pem
  Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>
